<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="$(arg name)">

    <xacro:arg name="name" default="mav500_drive_system"/>

    <xacro:arg name="prefix" default="" />

    <xacro:arg name="bus_config" default=""/>
    <xacro:arg name="master_config" default=""/>
    <xacro:arg name="master_bin" default=""/>
    <xacro:arg name="can_interface_name" default="vcan0"/>


    <!-- ros2 control include -->
    <xacro:include filename="$(find diff_canopen_system)/urdf/mav1500/mav1500_new.ros2_control.xacro"/>

    <xacro:mav1500_ros2_control
      name="$(arg name)"
      prefix="$(arg prefix)"
      bus_config="$(arg bus_config)"
      master_config="$(arg master_config)"
      can_interface_name="$(arg can_interface_name)"
      master_bin="$(arg master_bin)"
    />

    <link name="$(arg prefix)base_link"/>
    <link name="$(arg prefix)left_wheel_link">
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <cylinder radius="0.1" length="1.0"/>
        </geometry>
      </visual>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <cylinder radius="0.1" length="1.0"/>
        </geometry>
      </collision>
    </link>

    <link name="$(arg prefix)right_wheel_link">
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <cylinder radius="0.1" length="1.0"/>
        </geometry>
      </visual>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <cylinder radius="0.1" length="1.0"/>
        </geometry>
      </collision>
    </link>

    <joint name="$(arg prefix)left_wheel" type="revolute">
        <parent link="$(arg prefix)base_link" />
        <child link="$(arg prefix)left_wheel_link" />
        <origin xyz="0 0 0" rpy="0 0 0" />
        <axis xyz="0 0 1" />
        <limit lower="${-2*pi}" upper="${2*pi}" effort="10.0" velocity="0.5"/>
    </joint>

    <joint name="$(arg prefix)right_wheel" type="revolute">
        <parent link="$(arg prefix)base_link" />
        <child link="$(arg prefix)right_wheel_link" />
        <origin xyz="0 0 0" rpy="0 0 0" />
        <axis xyz="0 0 1" />
        <limit lower="${-2*pi}" upper="${2*pi}" effort="10.0" velocity="0.5"/>
    </joint>

</robot>
